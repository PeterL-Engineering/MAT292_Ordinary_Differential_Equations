\documentclass{article} % For LaTex2e
\usepackage{iclr2022_conference,times}
% Optional math commands from https://github.com/goodfeli/dlbook_notation.
\input{math_commands.tex}

%######## MAT292: Uncomment your submission name
\newcommand{\matname}{ - Group 1 Project Proposal}
%\newcommand{\matname}{Progress Report}
%\newcommand{\matname}{Final Report}

%######## MAT292: Put your Group Number here
%\newcommand{\gpnumber}{40}

\usepackage{hyperref}
\usepackage{xcolor}
\usepackage[normalem]{ulem}
\usepackage{url}
\usepackage{graphicx}
\usepackage{placeins}
\usepackage{float}
\usepackage{tikz}
\usepackage{multicol, breqn}
\usepackage{caption}

%######## MAT292: Put your project Title here
\title{Real-Time Neural Signal Filtering via \\
Hodgkin-Huxley Simulation Models}

%######## MAT292: Put your names, student IDs and Emails here
\author{\textbf{Peter Leong} \\
    Student\# 1010892955 \\
    peter.leong@mail.utoronto.ca
\And
    \textbf{Karys Littlejohns} \\
    Student\# 1010893142 \\
    karys.littlejohns@mail.utoronto.ca
\And
    \textbf{Katherine Shepherd} \\
    Student\# 1010895097 \\
    k.shepherd@mail.utoronto.ca
}



\iclrfinalcopy 
%######## MAT292: Document starts here
\begin{document}

\maketitle

% add vertical space between authors and abstract
%\vspace{2ex}   % <-- adjust this value as needed


% \begin{abstract}

% %######## MAT292: Do not change the next line. This shows your Main body page count.
% ----Total Pages: \pageref{last_page}
% \end{abstract}

\vspace{2ex}

\begin{multicols}{2}

\section{Introduction}
\label{sec:introduction}
Spike detection from noisy extracellular recordings is crucial for advancing brain-computer interfaces and neuroscience research. 
Neural action potentials are well-modeled by the Hodgkin-Huxley (H-H) equations, which describe the ionic conductance changes underlying these waveforms. 
Our work adapts H-H generated waveforms to simulate realistic noisy conditions.

Beyond EEG and microelectrode arrays, neural signal processing enables critical applications including epileptic seizure prediction \citep{addai-domfe2024epileptic} and adaptive deep brain stimulation for Parkinson's disease \citep{aljalal2022parkinson}. 
The emergence of high-density neural probes further motivates efficient filtering solutions for handling large data streams \citep{ye2024ultra}. 

The primary goal of this project is to develop and validate a spike detection algorithm that operates accurately in low signal-to-noise ratio environments by leveraging synthetic data generated from the H-H model.

\section{Scope \& Feasibility}
\label{sec:scope_feasibility}

This project applies concepts from ESC103: Engineering Mathematics \& Computation and MAT292: Ordinary Differential Equations through four sequential, feasible phases:
(1) generating synthetic neural data by solving the Hodgkin-Huxley equations,
(2) processing this data with a digital filter,
(3) developing a spike detection algorithm, and
(4) quantitative comparison using Peak-Signal-to-Noise Ratio and local truncation error analysis.
The phased approach and inclusion of buffer time make this scope achievable within the 12-week timeline.

\subsection{Project Objectives}
\label{subsec:project_objectives}

\textbf{Data Generation:} Implement numerical solvers for the Hodgkin-Huxley model to generate realistic synthetic action potential data.

\textbf{Signal Processing:} Design and apply a digital band-pass filter to isolate spike waveforms from generated signals with added synthetic noise.

\textbf{Spike Detection:} Develop an algorithm that detects action potentials using an adaptive threshold based on the estimated noise floor.

\textbf{Validation:} Qualitatively and quantitatively assess detection algorithm performance on noisy synthetic data.

\subsection{Project Milestones \& Timeline}
\label{subsec:milestones_timeline}

Key milestones from our detailed Gantt chart (\ref{app:a_gantt_chart}) ensure steady progress toward our objectives: \textbf{Week 4:} Complete Euler's and Improved Euler's method solvers and first noise generation algorithm.
\textbf{Week 6:} Implement Runge-Kutta method solver(s) and first band-pass filter iteration.
\textbf{Week 8:} Refine all components: band-pass filter, noise generation, and numerical methods.
\textbf{Week 10:} Final results evaluation and report completion.
\textbf{Weeks 11-12:} Buffer time for unexpected delays.
\section{Technical Background}
\label{sec:technical_background}

Understanding neuronal biology is essential for appreciating the abstractions in the Hodgkin-Huxley equations. 
This section covers the fundamentals of neural action potentials, the underlying biochemical processes, key equations from the H-H model, and the numerical methods used in our analysis.

\subsection{The Biological Basis: Ion Channels and Currents}
\label{subsec:biological_basis}

Cells communicate via current signals, supporting not only the neural signalling process, but also fundamental processes like muscle contraction, nutrient transport, and cellular homeostasis. 
These current signals work tangentially with ion channelsâ€”pores discovered by Hodgkin and Huxley that use selective permeability to regulate intramolecular transport across lipid bilayers. 
Ion channels occur when current flows across a cell membrane. This transport occurs bi-directionally, its flux reversing as the Nernst potential is reached (zero-current state). 
Ion channel movement can be measured via the ionic currents that pass through, this measurement is based on Ohm's Law \citep{rubaiy2017electrophysiology}.

\subsection{The Cell Membrane and Electric Potentials}
\label{subsubsec:resting_potential}

Action potential is the change in membrane electric potential that creates ion channels \cite{rubaiy2017electrophysiology}. 
The cell electrical state is measured as $V_{m}$, the potential difference between the cytoplasm and external environment \cite{cervera2016bioelectrical}. 
In their resting state, cell membranes possess a net negative charge (resting potential), preventing ion channel creation. 
Depolarization occurs when a membrane changes from a net negative charge to a net positive charge, opening an ion channel \cite{rubaiy2017electrophysiology}. 
This electrical bi-stability of depolarization to resting state is an important characteristic of neural cells \cite{cervera2016bioelectrical}.

\subsection{Hodgkin-Huxley Equations}
\label{subsec:hodgekin_huxley}

The Hodgkin-Huxley model is a system of nonlinear differential equations that represent action potentials movement through nerve cells by three types of ion current: sodium, potassium, and a leak current. 
Describing the transfer of these ions with a circuit allows for equations that model cells electrical properties \cite{Schwiening2012}. 

\subsubsection{Model Components and Equations}
\label{subsubsec:hh_equations}
\begin{minipage}{\linewidth}
    \centering
    \includegraphics[width=0.9\linewidth]{Figs/ion_circuit.png}
    \captionof{figure}{Circuit representation of ion transfer across the cell membrane \cite{Gerstner2014}}
    \label{fig:ion_circuit}
\end{minipage}
The circuit model represents each component of ion transfer within a nerve cell as an electrical component: 
the ion pumps and the leak channel are represented as resistors; the difference in ion concentration for each ion is represented by a battery; the lipid bilayer is represented by a capacitor \cite{Gerstner2014}.
These components are combined according to the circuit in Figure~\ref{fig:ion_circuit}, to create the equation for current across the cell membrane:
\begin{dmath}
    I = C_{M}\frac{dV}{dt} + \bar{g}_{K}n^4(V - V_{K}) + \bar{g}_{Na}m^3h(V - V_{Na}) + \bar{g}_{l}(V - V_{l})
    \label{eq:ion_current}
\end{dmath}
Relating Equation~\ref{eq:ion_current} to Figure~\ref{fig:ion_circuit}, V is analogous to u, and $V_x$ to $E_x$ (where x represents Na, K, or l). Discerned from the resistance values, $g_x$ (where x is Na, K, or l) represents the maximum conductance of the channel.

\subsubsection{Gating Variables and Activation/Inactivation}
\label{subsubsec:gating_variables}

Hodgkins and Huxley theorized that specific ammounts of charged particles would need to move under influence of the membrane potential to allow $Na^+$ or $K^+$ particles to move \cite{Schwiening2012}.
Based on this theory, the model uses three gating variables (m, n, and h) to represent the probability that a channel will be open at a given moment in time. 
For the $Na^+$ channels, m describes the activation of the channel and h is its inactivation. 
Similarly, n describes the activation of the $K^+$ channels.
They found that $n^4$, $m^3$, and h provided a good fit \cite{Schwiening2012}. 
The gating variables are represented across a range of potentials by equations of the form:
\begin{dmath}
    \dot{x} = -\frac{1}{\tau_{x}(u)}[x - x_{0}(u)]
    \label{eq:gating_variables}
\end{dmath}
To interpret Equation~\ref{eq:gating_variables}, let $\dot{x}$ = $\frac{dx}{dt}$ where x stands for m, n, or h. $\tau_0$(u) and $x_0$(u) are conditional variables dependent on the initial membrane potential \cite{Gerstner2014}.

\subsection{Numerical Methods}
\label{subsec:numerical_methods}

Many real-world differential equations do not possess elegant algebraic solutions; however, this does not prevent us from understanding their solutions. 
Numerical methods offer a powerful alternative, enabling us to visualize and approximate solutions with considerable accuracy. 
Our work focuses on three foundational techniques: Euler's Method, Improved Euler's Method, and the Runge-Kutta Method. 
We detail Euler's Method in this section, while comprehensive explanations of the others are available in \ref{app:c_numerical_methods}. 
All derivations and governing equations are sourced from \cite{brannan2015differential}.

\subsubsection{Euler's Method}
\label{subsubsec:euler_method}

Intuitively, Euler's Method solves the initial value problem by constructing an approximate solution from connected tangent line segments over discrete time intervals. 
Given a differential equation with initial condition:
\[
    \frac{dy}{dt} = f(t, y) \quad \text{with} \quad y(t_0) = y_0
\]
we begin at the initial point $(t_0, y_0)$ and use the slope given by $f(t_0, y_0)$ to construct the first tangent line:
\[
    y = y_0 + f(t_0, y_0)(t - t_0)
\]
This linear approximation provides our next point $(t_1, y_1)$ by evaluating at $t = t_1$. We then iterate this process, using each new point $(t_n, y_n)$ to compute the next approximation:
\[
    y_{n+1} = y_n + f(t_n, y_n) \cdot \Delta t
\]
where $\Delta t = t_{n+1} - t_n$ is the fixed step size. 
As the number of steps increases and $\Delta t$ decreases, this piecewise linear approximation converges toward the true solution curve $\phi(t)$.

\label{last_page}

\newpage
\bibliographystyle{iclr2022_conference}
\bibliography{MAT292_Proposal_Ref}

\end{multicols}

\newpage
\appendix

\section{Gantt Chart}
\label{app:a_gantt_chart}
\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.88\linewidth]{Figs/gantt_chart_rot.png}
    \caption{Our project plan is organized into three distinct phases with integrated buffers between them.
            Direct access to the chart can be found \href{https://docs.google.com/spreadsheets/d/1jHzTcHqw4nSWZ5ZlPa9hzeYbwHf0eZ49koE-SQ0onvM/edit?usp=sharing}{here}}
\end{figure}

\end{document}
