\documentclass{article} % For LaTex2e
\usepackage{iclr2022_conference,times}
% Optional math commands from https://github.com/goodfeli/dlbook_notation.
\input{math_commands.tex}

%######## MAT292: Uncomment your submission name
\newcommand{\matname}{ - Project Proposal}
%\newcommand{\matname}{Progress Report}
%\newcommand{\matname}{Final Report}

%######## MAT292: Put your Group Number here
%\newcommand{\gpnumber}{40}

\usepackage{hyperref}
\usepackage{xcolor}
\usepackage[normalem]{ulem}
\usepackage{url}
\usepackage{graphicx}
\usepackage{placeins}
\usepackage{float}
\usepackage{tikz}
\usepackage{multicol}

%######## MAT292: Put your project Title here
\title{Real-Time Neural Signal Filtering via \\
Hodgkin-Huxley Simulation Models}

%######## MAT292: Put your names, student IDs and Emails here
\author{\textbf{Peter Leong} \\
    Student\# 1010892955 \\
    peter.leong@mail.utoronto.ca
\And
    \textbf{Karys Littlejohns} \\
    Student\# 1010893142 \\
    karys.littlejohns@mail.utoronto.ca
\And
    \textbf{Katherine Shepherd} \\
    Student\# 1010895097 \\
    k.shepherd@mail.utoronto.ca
}



\iclrfinalcopy 
%######## MAT292: Document starts here
\begin{document}

\maketitle

% add vertical space between authors and abstract
%\vspace{2ex}   % <-- adjust this value as needed


\begin{abstract}

%######## MAT292: Do not change the next line. This shows your Main body page count.
----Total Pages: \pageref{last_page}
\end{abstract}

\vspace{2ex}

\begin{multicols}{2}

\section{Introduction}
\label{sec: introduction}

\section{Motivation \& Relevance}
\label{sec: motivation_relevance}

In the field of biomedical engineering, extracting action potential timings from noisy extraceulluar recordings is essential in advancing brain-computer interfaces and neuroscience research.
While spike detection itself is a signal processing task, the underlying signal can be described and approximated by the Hodgkin-Huxley (H-H) model.
This set of non-linear ordinary differential equations models the ionic conductance changes that generate the action potential waveform.
Our challenge is to adapt the H-H waveforms to mimic the noise present in real-life data.

Beyond common EEG readings or microelectrode arrays, neural signal filtering and spike detection is relevant to other closed-loop systems such as epileptic seizure prediction \citep{addai-domfe2024epileptic} or adaptive deep brain stimulation for Parkinson's disease \citep{aljalal2022parkinson}.
Advancements in filtering are further motivated by the advent of high-density neural probes which generate large data streams requiring efficient, accurate processing solutions \citep{ye2024ultra}.
This project aims to develop a spike detection algorithm based on the H-H model to improve accuracy in low signal-to-noise ratio (SNR) environments.

\section{Scope \& Feasibility}
\label{sec: scope_feasibility}

The scope of this project builds upon concepts from ESC103: Engineering Mathematics \& Computation and MAT292: Ordinary Differential Equations. 
The work is divided into three primary phases: (1) generating synthetic neural data by solving the Hodgkin-Huxley equations, (2) processing this data with a digital filter, and (3) developing a spike detection algorithm.

\subsection{Project Objectives}
\label{subsec: project_objectives}

The primary objectives of this project are:

\textbf{Data Generation:} To implement numerical solvers for the Hodgkin-Huxley (H-H) model to generate realistic synthetic action potential data.
    
\textbf{Signal Processing:} To design and apply a digital band-pass filter to isolate the spike waveform from the generated signal and added synthetic noise.

\textbf{Spike Detection:} To develop an algorithm that detects action potentials using an adaptive threshold, calculated from the estimated noise floor of the processed signal.

\textbf{Validation:} To qualitatively and quantitatively assess the performance of the detection algorithm on the noisy synthetic data.

\subsection{Project Milestones \& Timeline}
\label{subsec:milestones_timeline}

Although a more detailed outline of our project milestones and timeline can be found in \ref{app: appendix_a}, several high-level milestones are listed below.

\textbf{Week 4: } Finish implementation of Euler's and Improved Euler's method solvers. Also complete first iteration of noise generation algorithm.

\textbf{Week 6: } Finish implementation of Runge-Kutta method solver(s), and complete first iteration of band-pass filter.

\textbf{Week 8: } Refine band-pass filter, noise generation algorithm, and numerical methods.

\textbf{Week 10: } Discuss and evaluate results in the final report.

\textbf{Week 11/12: } Buffer time in case aforementioned tasks take longer than initially anticipated.


\section{Technical Background}
\label{sec:technical_background}

Understanding the bioligical model of neuron signals is imperative to acknowledging the abstractions and simplfications made to obtain the H-H equations.
In this section, we overview the basics behind action potential in the brain, and biochemical processes that occur to produce these phenomena.
Additionally, we outline the handful of key equations we intend to use from the H-H model, and discuss the theory behind the nuermical methods we have chosen.

\subsection{The Biological Basis: Ion Channels and Currents}
\label{subsec:biological_basis}

Electrophysiology—the study of electrical properties of cells—provides the basis for cell communication via current signals. This supports not only the neural signalling process, but also fundamental processes like muscle contraction, nutrient transport, and cellular homeostasis. These current signals work tangentially with ion channels—pores discovered by Hodgkin and Huxley that use selective permeability to regulate intramolecular transport across lipid bilayers. Ion channels occur when current flows across a cell membrane. This transport occurs bi-directionally, its flux reversing as the Nernst potential is reached (zero-current state). Ion channel movement can be measured via the ionic currents that pass through, this measurement is based on Ohm's Law \citep{rubaiy2017electrophysiology}.

\subsubsection{The Cell Membrane and Electric Potentials}
\label{subsubsec:resting_potential}

Action potential is the change in membrane electric potential that creates ion channels \cite{rubaiy2017electrophysiology}. 
The cell electrical state is measured as $V_{m}$, the potential difference between the cytoplasm and external environment \cite{cervera2016bioelectrical}. 
In their resting state, cell membranes possess a net negative charge (resting potential), preventing ion channel creation. 
Depolarization occurs when a membrane changes from a net negative charge to a net positive charge, opening an ion channel. 
Repolarization occurs when the membrane regains its negative charge, closing the ion channel \cite{rubaiy2017electrophysiology}. 
This electrical bi-stability of depolarization to repolarization is an important characteristic of neural cells \cite{cervera2016bioelectrical}.

\subsubsection{Voltage-Gated Ion Channels}
\label{subsubsec:vgic}

Ion channels use several mechanisms to facilitate movement, for example, active transport against a concentration gradient, or passive transport with the concentration gradient. Passive systems employ gating, ion conductance, and selectivity to regulate movement. Gated channels leverage protein C- and N-termini to open and close a pore across transmembrane domains, increasing control of ion flow. A common gating mechanism are voltage-gated ion channels (VGICs), which regulate transport via transmembrane voltage changes. VGICs are critical to neurons and play key roles in repolarization, signal regulation, and propogation of electrical impulses \cite{rubaiy2017electrophysiology}. 

\subsubsection{Sodium-Potassium Pump}
\label{subsubsec:na_k_pump}

A concentration imbalance exists between the internal and external environments of a cell, with potassium ($K^{+}$) being high within the cell and low outside, and sodium ($Na^{+}$) being low within the cell and high outside. In the resting state, the membrane is more permeable to $K^{+}$, meaning an entity must maintain this electric gradient and reduce $K^{}$ loss. This entity is the sodium-potassium pump, which uses an energy source called ATP (adenosine triphosphate) to remove three $Na^{+}$ for every two $K^{+}$ that enter. This creates a more negative environment, regulating the cell membrane resting potential. The $Na^{+}$/$K^{+}$ pump also plays a role in the modulation of neurotransmitter receptors in neurons \cite{pivovarov2018na/kpump}. 

\subsection{Modeling Neurons as Electrical Circuits}
\label{subsec:circuit_model}
\subsubsection{The Parallel Conductance Model}
\label{subsubsec:parallel_conductance}
\subsubsection{Circuit Analogs: Capacitors, Resistors, and Batteries}
\label{subsubsec:circuit_analogs}

\subsection{Hodgkin-Huxley Equations}
\label{subsec:hodgekin_huxley}
\subsubsection{Model Components and Equations}
\label{subsubsec:hh_equations}
\subsubsection{Gating Variables and Activation/Inactivation}
\label{subsubsec:gating_variables}

\subsection{Numerical Methods}
\label{subsec:numerical_methods}

Oftentimes in real-world modelling, differential equations do not have an algebraic solution.
This does not impede our ability to visualize or obtain results as we can instead turn to numerical methods to approximate the solution.
Within the field of numerical methods and computation, there are numerous methods to approximate a solution, however we will focus on three main methods: Euler's Method, Improved Euler's Method, and Runge-Kutta Methods.
All derivations and equations are taken from \cite{brannan2015differential}.

\subsubsection{Euler's Method}
\label{subsubsec:euler_method}

Intuitively, Euler's Method solves the initial value problem by linking tangent lines for a finite number of time steps of size $\Delta t$.
Given a differential equation and initial condition:

\[
    \frac{dy}{dt} = f(t, y) \quad \text{where} \quad y(t_{0}) = y_{0}
\]

we can approximate the tangent line of the solution at the initial point $(t_{0}, y_{0})$ by:

\[
    y = y_{0} + f(t_{0}, y_{0})(t - t_{0})
\]

We approximate the solution at some $y_{i}$ by using the tangent line from the previous point (starting at $t_{0}$) to obtain more points.
As we increase the number of time steps and consequently decrease the size of $\Delta t$, we can improve our approximation of the solution curve.
Thus, we can generalize the approximation of the solution $\phi(t)$ with the following equation:

\[
    y_{n+1} = y_{n} + f(t_{n}, y_{n}) \cdot (t_{n+1} - t_{n})
\]

\subsubsection{Improved Euler's Method}
\label{subsubsec:improved_euler_method} % Removed space after colon

Though Euler's Method can give us a relatively concrete idea of the behaviour of the solution, it requires a large number of time steps to achieve accurate results.
Thus, many such methods aim to improve upon this base including Improved Euler's Method.
Intuitively, this method simply builds upon Euler's Method by considering the derivative at the subsequent point and computing the average.
We can define the general formula for the Improved Euler's Method with the following:
\[
    y_{n+1} = y_{n} + \frac{f_{n} + f(t_{n} + h, y_{n} + hf_{n})}{2}h
\]
such that 
\[
    h = t_{n + 1} - t_{n} \text{and} f_{n} = f(t_{n}, y_{n})
\]

\subsubsection{Runge-Kutta Methods}
\label{subsubsec:runge_kutta}

Euler's Method and Improved Euler's Method are technically considered Runge-Kutta class of numerical methods; however, in this section we will discuss the original methods developed by Runge and Kutta.
This method is classified as a fourth-order, four-stage Runge Kutta Method, but is commonly referred to as ``the'' Runge-Kutta Method.
Essentially, this method builds upon the two aforementioned methods by computing a weighted average of values at different points along the time step $\Delta t$.
The general form for the approximation of the solution is given by:
\[
    y_{n+1} = y_{n} + h \cdot \frac{k_{n1} + 2k_{n2} + 2k_{n3} + k_{n4}}{6}
\]
where we define each $k_{ni}$ as the following:
\[
    k_{n1} = f(t_{n}, y_{n})
\]
\[
    k_{n2} = f\left(t_{n} + \frac{1}{2}h, y_{n} + \frac{1}{2}hk_{n1}\right)
\]
\[
    k_{n3} = f\left(t_{n} + \frac{1}{2}h, y_{n} + \frac{1}{2}hk_{n2}\right)
\]
\[
    k_{n4} = f(t_{n} + h, y_{n} + hk_{n3})
\]

\section{Conclusion}

The H-H model and its equations help describe a plethora of phenomena in the neuroscience.
We aim to leverage its primary function of describing action potential to develop a high-band pass filter.
Through doing so, we will implement and compare three key numerical methods: Euler's Method, Improved Euler's Method, and Runge-Kutta Method.

\label{last_page}

\newpage
\bibliographystyle{iclr2022_conference}
\bibliography{MAT292_Proposal_Ref}


\end{multicols}

\newpage
\appendix

\section{Gantt Chart}
\label{app: appendix_a}


\end{document}
